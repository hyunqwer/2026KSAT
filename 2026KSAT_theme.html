<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>윤선생 커리큘럼: 2026 수능 적중 분석 리포트</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- FontAwesome (for icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts (Noto Sans KR) -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">

    <!-- Chosen Palette: Warm Professional & Academic Excellence
         Background: #FAFAF9 (Stone 50) - Warm, paper-like neutral
         Primary Text: #44403C (Stone 700)
         Accent/Brand: #D97706 (Amber 600) - Symbolizing Gold/Excellence/Success
         Secondary: #78716C (Stone 500)
         Card Bg: #FFFFFF (White)
    -->
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #FAFAF9;
            color: #44403C;
        }
        
        /* Chart Container Styling - MANDATORY Compliance */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px; /* Constraint for large screens */
            height: 300px;   /* Base height */
            max-height: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Custom Scrollbar for list areas */
        .custom-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: #f5f5f4; 
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #d6d3d1; 
            border-radius: 4px;
        }
        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #a8a29e; 
        }

        .fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>

    <!-- Application Structure Plan: 
         1. Header/Hero: Establishes credibility with the "100% Match" claim and navigation.
         2. Dashboard Overview: High-level quantitative view using Charts (Topic Distribution & Coverage Balance).
         3. Interactive Evidence Explorer: The core interactive element.
            - Left Panel: Filterable list of CSAT Question Types (Listening/Reading).
            - Right Panel: Detailed view showing the CSAT Requirement vs. MULTIPLE Yoon Textbook Extracts.
            - User Flow: Select Mode (L/R) -> Filter Category -> Click Question -> Read Proof.
         4. Key Strengths: Qualitative summary cards (Real-life, Academic, Critical Thinking).
         
         Rationale: This structure leads the user from the "Promise" (Hero) to the "Proof" (Explorer) to the "Value" (Strengths).
    -->

    <!-- Visualization & Content Choices:
         1. Doughnut Chart: To show the balanced distribution of topics (Daily Life, Science, Logic, etc.).
         2. Bar Chart: To visualize the volume of matches across Listening and Reading.
         3. Interactive List & Card View: Replaces the long static table. Allows users to focus on one question type at a time while seeing all related textbook extracts.
         
         CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. Charts rendered via Chart.js Canvas.
    -->
</head>
<body class="antialiased selection:bg-amber-100 selection:text-amber-900 flex flex-col min-h-screen">

    <!-- Navigation -->
    <header class="bg-white border-b border-stone-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2 cursor-pointer" onclick="location.reload()">
                <i class="fa-solid fa-graduation-cap text-amber-600 text-2xl"></i>
                <h1 class="font-bold text-xl tracking-tight text-stone-800">윤선생 <span class="text-amber-600">수능 적중</span> 리포트</h1>
            </div>
            <nav class="hidden md:flex space-x-8">
                <button onclick="scrollToSection('dashboard')" class="text-stone-600 hover:text-amber-600 font-medium transition text-sm">대시보드</button>
                <button onclick="scrollToSection('explorer')" class="text-stone-600 hover:text-amber-600 font-medium transition text-sm">적중 증명 탐색기</button>
                <button onclick="scrollToSection('analysis')" class="text-stone-600 hover:text-amber-600 font-medium transition text-sm">핵심 강점</button>
            </nav>
            <button class="md:hidden text-stone-600" onclick="alert('데스크탑 화면에서 최적의 경험을 제공합니다.')">
                <i class="fa-solid fa-bars"></i>
            </button>
        </div>
    </header>

    <main class="flex-grow">
        <!-- Hero Section -->
        <section class="bg-gradient-to-b from-amber-50 to-stone-50 py-16 px-4 text-center relative overflow-hidden">
            <!-- Decorative BG elements -->
            <div class="absolute top-0 left-0 w-full h-full overflow-hidden opacity-10 pointer-events-none">
                <i class="fa-solid fa-quote-right absolute top-10 left-10 text-9xl text-amber-300 transform -rotate-12"></i>
                <i class="fa-solid fa-check-double absolute bottom-10 right-10 text-9xl text-amber-300 transform rotate-12"></i>
            </div>

            <div class="max-w-4xl mx-auto space-y-6 relative z-10">
                <div class="inline-flex items-center px-4 py-1.5 bg-white border border-amber-200 text-amber-700 rounded-full text-sm font-bold shadow-sm mb-4">
                    <span class="w-2 h-2 bg-amber-500 rounded-full mr-2 animate-pulse"></span>
                    2026학년도 수능 영어 완벽 대비
                </div>
                <h2 class="text-4xl md:text-5xl lg:text-6xl font-black text-stone-900 leading-tight tracking-tight">
                    수능 영어, 우연이 아닌 필연!<br>
                    <span class="text-amber-600 relative inline-block">
                        100% 유사 소재
                        <svg class="absolute w-full h-3 -bottom-1 left-0 text-amber-200 -z-10" viewBox="0 0 100 10" preserveAspectRatio="none"><path d="M0 5 Q 50 10 100 5" stroke="currentColor" stroke-width="8" fill="none" /></svg>
                    </span>를 증명하다
                </h2>
                <p class="text-lg text-stone-600 max-w-2xl mx-auto leading-relaxed pt-4">
                    2026 수능 영어의 모든 영역(듣기 16문항, 읽기 28문항) 소재가 윤선생 교재에 이미 존재했습니다.
                    데이터로 증명된 윤선생 커리큘럼의 압도적인 적중률을 직접 확인하세요.
                </p>
                <div class="pt-8 flex flex-col sm:flex-row justify-center gap-4">
                    <button onclick="scrollToSection('explorer')" class="bg-amber-600 hover:bg-amber-700 text-white font-bold py-3.5 px-8 rounded-xl shadow-lg shadow-amber-200 transform transition hover:-translate-y-1 flex items-center justify-center">
                        <i class="fa-solid fa-magnifying-glass mr-2"></i> 적중 사례 확인하기
                    </button>
                    <button onclick="scrollToSection('dashboard')" class="bg-white hover:bg-stone-50 text-stone-700 font-bold py-3.5 px-8 rounded-xl border border-stone-200 shadow-sm transform transition hover:-translate-y-1">
                        데이터 분석 보기
                    </button>
                </div>
            </div>
        </section>

        <!-- Dashboard Section -->
        <section id="dashboard" class="py-16 px-4 max-w-7xl mx-auto">
            <div class="mb-10 text-center">
                <h3 class="text-2xl font-bold text-stone-800 mb-3 relative inline-block">
                    커리큘럼 소재 분석 대시보드
                    <span class="absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-12 h-1 bg-amber-500 rounded"></span>
                </h3>
                <p class="text-stone-600 max-w-3xl mx-auto mt-4">
                    이 섹션에서는 윤선생 교재가 다루고 있는 주제의 다양성과 수능 문항과의 연계성을 시각적으로 보여줍니다. 
                    일상적인 대화부터 고난도 학술 지문까지, 윤선생 커리큘럼은 수능이 요구하는 모든 스펙트럼을 포괄하고 있습니다.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Chart 1: Topic Distribution -->
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-stone-100 flex flex-col">
                    <div class="flex items-center justify-between mb-6">
                        <h4 class="text-lg font-bold text-stone-700 border-l-4 border-amber-500 pl-3">주제별 커버리지 분포</h4>
                        <span class="text-xs font-medium text-stone-400 bg-stone-100 px-2 py-1 rounded">다양성 분석</span>
                    </div>
                    <div class="chart-container flex-grow">
                        <canvas id="topicChart"></canvas>
                    </div>
                    <p class="text-xs text-stone-500 mt-4 text-center bg-stone-50 py-2 rounded">
                        * 듣기와 읽기 전 영역에 걸쳐 인문, 사회, 과학, 예술 등 다양한 소재가 균형 있게 배치되어 있습니다.
                    </p>
                </div>

                <!-- Chart 2: Question Type Count -->
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-stone-100 flex flex-col">
                    <div class="flex items-center justify-between mb-6">
                        <h4 class="text-lg font-bold text-stone-700 border-l-4 border-amber-500 pl-3">영역별 문항 매칭 현황</h4>
                        <span class="text-xs font-medium text-stone-400 bg-stone-100 px-2 py-1 rounded">총 45문항 대비</span>
                    </div>
                    <div class="chart-container flex-grow">
                        <canvas id="typeChart"></canvas>
                    </div>
                    <p class="text-xs text-stone-500 mt-4 text-center bg-stone-50 py-2 rounded">
                        * 듣기(16) / 읽기(28) 전체 문항에 대해 유사 소재가 확인되었습니다.
                    </p>
                </div>
            </div>
        </section>

        <!-- Explorer Section (Core Feature) -->
        <section id="explorer" class="py-16 px-4 bg-stone-100 border-t border-stone-200">
            <div class="max-w-7xl mx-auto">
                <div class="mb-8">
                    <h3 class="text-2xl font-bold text-stone-800 mb-2">
                        <i class="fa-solid fa-layer-group text-amber-600 mr-2"></i>적중 증명 탐색기 (Evidence Explorer)
                    </h3>
                    <p class="text-stone-600 text-sm md:text-base">
                        아래 탐색기를 통해 실제 수능 문항 소재와 윤선생 교재의 지문(Source Extract)을 직접 비교해보세요.
                        <span class="font-semibold text-amber-700">하나의 수능 문항에 대해 여러 개의 교재 지문이 매칭된 사례</span>를 모두 확인할 수 있습니다.
                    </p>
                </div>

                <!-- Controls Toolbar -->
                <div class="bg-white p-4 rounded-xl shadow-sm border border-stone-200 mb-6 flex flex-col md:flex-row justify-between items-center gap-4">
                    <!-- Toggle Buttons -->
                    <div class="bg-stone-100 p-1 rounded-lg flex w-full md:w-auto">
                        <button id="btn-listening" onclick="setMode('Listening')" class="flex-1 md:flex-none px-6 py-2 rounded-md text-sm font-bold transition-all shadow-sm bg-white text-amber-600 border border-stone-200">
                            <i class="fa-solid fa-headphones mr-2"></i>듣기 (Listening)
                        </button>
                        <button id="btn-reading" onclick="setMode('Reading')" class="flex-1 md:flex-none px-6 py-2 rounded-md text-sm font-bold transition-all text-stone-500 hover:text-stone-700 hover:bg-stone-200">
                            <i class="fa-solid fa-book-open mr-2"></i>읽기 (Reading)
                        </button>
                    </div>
                    
                    <!-- Filter Dropdown -->
                    <div class="relative w-full md:w-72">
                        <label for="categoryFilter" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-stone-400 text-xs font-bold uppercase pointer-events-none">Filter:</label>
                        <select id="categoryFilter" onchange="filterData()" class="w-full pl-16 pr-10 py-2.5 border border-stone-300 rounded-lg appearance-none focus:outline-none focus:ring-2 focus:ring-amber-500 bg-white text-stone-700 cursor-pointer text-sm font-medium shadow-sm hover:border-amber-400 transition-colors">
                            <option value="All">모든 카테고리 보기</option>
                            <!-- Options populated by JS -->
                        </select>
                        <div class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-stone-500">
                            <i class="fa-solid fa-chevron-down text-xs"></i>
                        </div>
                    </div>
                </div>

                <!-- Main Explorer Split View -->
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 h-[800px] lg:h-[700px]">
                    
                    <!-- Left Column: Item List -->
                    <div class="lg:col-span-4 bg-white rounded-xl border border-stone-200 shadow-sm flex flex-col overflow-hidden h-full">
                        <div class="p-4 bg-stone-50 border-b border-stone-200 flex justify-between items-center">
                            <span class="font-bold text-stone-700 text-sm"><i class="fa-solid fa-list-ul mr-2"></i>문항 리스트</span>
                            <span id="matchCount" class="text-xs bg-amber-100 text-amber-700 px-2.5 py-1 rounded-full font-bold">0건</span>
                        </div>
                        <div id="itemList" class="overflow-y-auto p-2 space-y-2 custom-scroll flex-1 bg-stone-50/50">
                            <!-- Items populated by JS -->
                        </div>
                    </div>

                    <!-- Right Column: Details View -->
                    <div class="lg:col-span-8 h-full">
                        <div id="detailView" class="bg-white rounded-xl border border-amber-100 shadow-md h-full flex flex-col relative overflow-hidden">
                            <!-- Default State -->
                            <div id="emptyState" class="absolute inset-0 flex flex-col items-center justify-center text-stone-400 bg-stone-50 z-10 p-8 text-center">
                                <div class="w-20 h-20 bg-stone-200 rounded-full flex items-center justify-center mb-4 text-stone-400">
                                    <i class="fa-regular fa-hand-pointer text-3xl"></i>
                                </div>
                                <h4 class="text-lg font-bold text-stone-600 mb-2">문항을 선택해주세요</h4>
                                <p class="text-sm">왼쪽 리스트에서 수능 문항 유형을 선택하면<br>상세한 윤선생 교재 적중 사례를 확인할 수 있습니다.</p>
                            </div>

                            <!-- Content State -->
                            <div id="contentState" class="hidden h-full flex flex-col">
                                <!-- Sticky Header -->
                                <div class="p-6 border-b border-stone-100 bg-white z-20 shadow-sm">
                                    <div class="flex items-start justify-between">
                                        <div>
                                            <span id="detailBadge" class="inline-block px-2.5 py-0.5 bg-stone-100 text-stone-600 rounded text-xs font-bold mb-2 uppercase tracking-wide border border-stone-200">Category</span>
                                            <h3 id="detailTitle" class="text-2xl font-black text-stone-800 leading-none mb-2">문항 제목</h3>
                                            <div class="flex items-center text-amber-600 font-medium text-sm">
                                                <i class="fa-solid fa-bullseye mr-2"></i>
                                                <span id="detailTopic">유사 소재: ...</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Scrollable Content -->
                                <div class="overflow-y-auto custom-scroll p-6 space-y-8 flex-1 bg-stone-50/30">
                                    
                                    <!-- Section 1: CSAT Context -->
                                    <div class="relative">
                                        <div class="absolute -left-3 top-0 bottom-0 w-1 bg-stone-300 rounded-full"></div>
                                        <h5 class="text-sm font-bold text-stone-500 uppercase mb-3 flex items-center pl-4">
                                            <i class="fa-solid fa-file-contract mr-2"></i> 수능 출제 경향 및 소재
                                        </h5>
                                        <div class="bg-white p-5 rounded-lg border border-stone-200 shadow-sm ml-1">
                                            <p id="detailContext" class="text-stone-800 leading-relaxed font-medium">
                                                이 유형은 ...
                                            </p>
                                        </div>
                                    </div>

                                    <!-- Section 2: Yoon Source Matches -->
                                    <div class="relative">
                                        <div class="absolute -left-3 top-0 bottom-0 w-1 bg-amber-500 rounded-full"></div>
                                        <h5 class="text-sm font-bold text-amber-700 uppercase mb-3 flex items-center pl-4">
                                            <i class="fa-solid fa-book-bookmark mr-2"></i> 윤선생 교재 적중 증거 (Source Extracts)
                                        </h5>
                                        
                                        <!-- Container for dynamic Matches -->
                                        <div id="matchesContainer" class="space-y-4 ml-1">
                                            <!-- Dynamic cards injected here -->
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Analysis Section -->
        <section id="analysis" class="py-16 px-4 max-w-7xl mx-auto">
            <div class="mb-12 text-center">
                <h3 class="text-2xl font-bold text-stone-800 mb-3">영역별 핵심 강점</h3>
                <p class="text-stone-600">
                    단순한 문제 풀이가 아닙니다. 윤선생 커리큘럼은 배경지식과 사고력을 동시에 확장합니다.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Card 1 -->
                <div class="group bg-white p-8 rounded-2xl shadow-sm border border-stone-100 hover:border-amber-200 hover:shadow-lg transition-all duration-300">
                    <div class="w-14 h-14 bg-amber-50 rounded-2xl flex items-center justify-center mb-6 group-hover:bg-amber-100 transition-colors">
                        <i class="fa-solid fa-earth-americas text-amber-600 text-2xl"></i>
                    </div>
                    <h4 class="text-xl font-bold text-stone-800 mb-3 group-hover:text-amber-700 transition-colors">실생활 완벽 대비</h4>
                    <p class="text-stone-600 text-sm leading-relaxed">
                        <span class="font-semibold text-stone-800 block mb-2">"약속, 쇼핑, 길 찾기 등 일상 대화가 곧 수능!"</span>
                        실생활 중심의 대화문으로 듣기 영역의 기초부터 실전까지 만점을 준비합니다.
                    </p>
                </div>

                <!-- Card 2 -->
                <div class="group bg-white p-8 rounded-2xl shadow-sm border border-stone-100 hover:border-amber-200 hover:shadow-lg transition-all duration-300">
                    <div class="w-14 h-14 bg-amber-50 rounded-2xl flex items-center justify-center mb-6 group-hover:bg-amber-100 transition-colors">
                        <i class="fa-solid fa-microscope text-amber-600 text-2xl"></i>
                    </div>
                    <h4 class="text-xl font-bold text-stone-800 mb-3 group-hover:text-amber-700 transition-colors">전문 지식 함양</h4>
                    <p class="text-stone-600 text-sm leading-relaxed">
                        <span class="font-semibold text-stone-800 block mb-2">"과학, 경제, 기술 등 최신 학술 주제"</span>
                        변인 통제, 한계 효용 등 전문 용어와 개념이 포함된 지문을 미리 접하여 독해의 깊이를 더합니다.
                    </p>
                </div>

                <!-- Card 3 -->
                <div class="group bg-white p-8 rounded-2xl shadow-sm border border-stone-100 hover:border-amber-200 hover:shadow-lg transition-all duration-300">
                    <div class="w-14 h-14 bg-amber-50 rounded-2xl flex items-center justify-center mb-6 group-hover:bg-amber-100 transition-colors">
                        <i class="fa-solid fa-brain text-amber-600 text-2xl"></i>
                    </div>
                    <h4 class="text-xl font-bold text-stone-800 mb-3 group-hover:text-amber-700 transition-colors">비판적 사고 완성</h4>
                    <p class="text-stone-600 text-sm leading-relaxed">
                        <span class="font-semibold text-stone-800 block mb-2">"예술 해석, 법과 자유, 미디어 비판"</span>
                        단순 해석을 넘어 문맥 속에 숨겨진 의미를 파악하는 고난도 추론 능력을 길러줍니다.
                    </p>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-stone-900 text-stone-400 py-12 border-t border-stone-800">
        <div class="max-w-4xl mx-auto px-4 text-center">
            <div class="flex items-center justify-center gap-2 mb-6 text-stone-200">
                <i class="fa-solid fa-graduation-cap text-2xl"></i>
                <span class="font-bold text-xl">윤선생 영어교실</span>
            </div>
            <p class="mb-6 text-sm leading-relaxed">
                본 리포트는 2026학년도 대학수학능력시험 영어 영역 문항과<br>윤선생 커리큘럼 교재 내 지문의 소재 유사성을 분석한 결과입니다.
            </p>
            <div class="text-xs text-stone-600">
                &copy; 2025 YOON'S ENGLISH SCHOOL. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- Script Logic -->
    <script>
        // --- 1. Data Source (Consolidated from User's Appendix) ---
        // 'matches' array contains objects with 'text' (extract) and 'source' (book ref).
        const curriculumData = [
            // --- Listening ---
            { 
                id: 'L1', section: 'Listening', type: '1. 짧은 대화', category: '일상/실용', topic: '만남 시간/장소 확인', 
                context: '약속 시간 정하기, 만날 장소 제안', 
                matches: [
                    { text: "What time shall we meet? How about five? That's fine with me. And where shall we meet? Let's meet at the bus stop.", source: "s08 POWERUP 1-1 1~2" },
                    { text: "Shall we meet at the library at 10:00? I'm sorry, but I can't. I have another appointment at 10:30.", source: "s12 POWERUP 3-1 1~2" },
                    { text: "When should we meet? Let's make it at seven, in front of the library.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" }
                ]
            },
            { 
                id: 'L2', section: 'Listening', type: '2. 짧은 대화', category: '일상/실용', topic: '물건 위치 묻기', 
                context: '잃어버린 물건 찾기, 위치 설명(가구 위/아래 등)', 
                matches: [
                    { text: "Honey, what are you looking for? My keys. Have you seen them? ... And have you looked in your wallet on the piano?", source: "s15 Yoon's Reading PALS D 10b" },
                    { text: "Mom, I think I left my cellphone in my room. ... Oh, wait, I found it! Thank God. Where was it? It was under your pillow.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" },
                    { text: "Where is my bag? It's on the desk.", source: "s08 POWERUP 1-1 1~2" }
                ]
            },
            { 
                id: 'L3', section: 'Listening', type: '3. 목적', category: '정보/공지', topic: '안내 방송: 행사 변경 안내', 
                context: '날씨나 사정으로 인한 일정/장소 변경 공지', 
                matches: [
                    { text: "Attention, passengers. Flight 216 for Los Angeles departing at 12:30 will be delayed due to bad weather. The new schedule for the flight will be announced later. We apologize for the inconvenience.", source: "s11 Yoon's 4-Skill Up(Fluent)" },
                    { text: "Attention all hikers. Bayside Canyon has just put out a warning that people should avoid hiking in this area. Due to a recent earthquake, the area has experienced some liquefaction.", source: "s15 English Immersion Weather and Geology 1~2" },
                    { text: "The picnic was canceled because of rain.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" }
                ]
            },
            {
                id: 'L4', section: 'Listening', type: '4. 의견', category: '학습/지식', topic: '건강/습관: 디지털 기기 사용',
                context: '스마트폰/컴퓨터 사용 제한, 건강한 생활 습관 조언',
                matches: [
                    { text: "It is bad for you to stare at a computer or a smartphone for a long time. I consider it necessary to only use electronics for less than one hour a day.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" },
                    { text: "Teens seem to be addicted to using computers... We should pass a law that makes using a computer illegal for anyone under a certain age.", source: "s14 English Immersion American culture 1~2" },
                    { text: "You should get more sleep. ... Yes, I was on the computer. Every night I stay up too late. ... I think you should organize your time better.", source: "s13 POWERUP 3-2 1~2" }
                ]
            },
            {
                id: 'L5', section: 'Listening', type: '5. 관계', category: '일상/실용', topic: '서비스/직업: 구체적 서비스 요청',
                context: '상점 주인과 손님, 도서관 사서와 이용자, 수리 요청',
                matches: [
                    { text: "May I help you? Yes, I'm looking for a flower basket. ... Give that special someone flowers to express your gratitude or love.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" },
                    { text: "Can I help you, ma'am? Yes, please. I'd like some novels. ... Can I check them out? Yes. You can check out novels.", source: "s15 Yoon's Reading PALS D 10b" },
                    { text: "This is room 502. There is a problem with the bathtub. The drain is clogged. ... Well prepare another room right away.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" }
                ]
            },
            {
                id: 'L6', section: 'Listening', type: '6. 그림', category: '일상/실용', topic: '묘사: 위치 및 동작 특정',
                context: '방 안의 물건 배치, 사람들의 동작 묘사',
                matches: [
                    { text: "There's a bed on the left side. I have two dolls on my bed. You can see a desk on the right. ... There is a clock on the wall over the desk.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" },
                    { text: "In picture A, the closet door is open while its closed in picture B. ... Next, in picture A, the cat is sleeping on the bed, but its jumping on the floor in picture B.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" },
                    { text: "The boy playing the violin is my brother. ... The book lying on the table is Greg's.", source: "s16 윤선생 수능 project(유형편) 1~3" }
                ]
            },
            {
                id: 'L7', section: 'Listening', type: '7. 할 일', category: '일상/실용', topic: '준비/협업: 부탁하기',
                context: '행사 준비, 물건 구매 부탁, 가사 분담',
                matches: [
                    { text: "Can you do me a favor? ... Will you go to the store and buy me some cookies and milk? ... I need some oranges and onions, too.", source: "s12 POWERUP 3-1 1~2" },
                    { text: "Mom and Dad's 15th wedding anniversary is coming up. ... Could you help me blow up some balloons? No problem!", source: "s11 SMART 중학영어 3학년(2학기) book5~8" },
                    { text: "Brad and Victoria are organizing a class party. ... Ill bring paper cups and plates. Dont forget to bring the decorations!", source: "s11 SMART 중학영어 3학년(2학기) book5~8" }
                ]
            },
            {
                id: 'L8', section: 'Listening', type: '8. 이유', category: '일상/실용', topic: '약속 이행 불가 사유',
                context: '병원 진료, 다른 일정, 가족 행사 등으로 인한 거절',
                matches: [
                    { text: "Sorry I can't come. I have an appointment with the doctor.", source: "s08 POWERUP 1-1 1~2" },
                    { text: "I'd love to, but I can't. I'm supposed to help my parents in the store that day.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" },
                    { text: "Hello, Minho, this is Sujin. I'm sorry to change our appointment. My mother had a traffic accident and I have to take care of her.", source: "s13 POWERUP 3-2 1~2" }
                ]
            },
            {
                id: 'L9', section: 'Listening', type: '9. 계산', category: '일상/실용', topic: '쇼핑/할인: 가격 계산',
                context: '물건 개수, 가격, 할인율 적용',
                matches: [
                    { text: "I bought a backpack here yesterday. It was 60,000 won, but now it's 50% off.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" },
                    { text: "Let's see, two hairbrushes and three combs, that's $20; plus six pairs of socks for $24. So that comes to $44. ... They are 50% off. Here's $40.", source: "s10 Yoon's Reading PALS B 8a" },
                    { text: "How much is it? The CD is 12,000 won plus a 10 percent shipping and handling charge.", source: "s15 Yoon's Reading PALS D 10b" }
                ]
            },
            {
                id: 'L10', section: 'Listening', type: '10. 불일치', category: '정보/공지', topic: '정보 확인: 안내문 내용',
                context: '동아리/행사 안내(일시, 장소, 대상, 준비물)',
                matches: [
                    { text: "Soccer Club... When: Every Monday Morning. Where: The Schools Soccer Field. What: Soccer Practice & Match. Who: Anyone Who Likes Soccer.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" },
                    { text: "We are holding our 4th English Song Contest next week. ... The winner gets a 32GB media player! You can apply via our school website...", source: "s11 SMART 중학영어 3학년(2학기) book5~8" }
                ]
            },
            {
                id: 'L11', section: 'Listening', type: '11. 짧은 대화', category: '일상/실용', topic: '제안/요청: 수락/거절',
                context: '식사 메뉴 제안, 주문 상황',
                matches: [
                    { text: "May I take your order? I'd like to have a steak. ... No, thanks. That will be it.", source: "s16 윤선생 수능 project(유형편) 1~3" },
                    { text: "What would you like to have? ... How about noodles in cold soup? That's fine with me.", source: "s16 윤선생 수능 project(유형편) 1~3" },
                    { text: "Would you like some more cookies? No, thanks. I've had enough.", source: "s16 윤선생 수능 project(유형편) 1~3" }
                ]
            },
            {
                id: 'L12', section: 'Listening', type: '12. 짧은 대화', category: '일상/실용', topic: '상황 대처: 길 찾기',
                context: '길을 잃었을 때, 특정 장소 위치 묻기',
                matches: [
                    { text: "Excuse me. How do I get to the bakery? Go straight and turn left. It's next to the hospital. ... Thank you.", source: "s12 POWERUP 3-1 1~2" },
                    { text: "I'm looking for my younger brother. It's hard to find him in this large park. Let's find him together.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" }
                ]
            },
            {
                id: 'L13', section: 'Listening', type: '13. 긴 대화', category: '학습/지식', topic: '고민 상담: 진로/학업',
                context: '발표 불안, 진로 문제, 성적 고민 상담',
                matches: [
                    { text: "I want to become an announcer, but I'm nervous in front of people. How can I fix this? ... Speak confidently so as not to seem nervous.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" },
                    { text: "What do you want to be in the future? I want to be a professional gamer, but my parents want me to be an announcer. ... Ill keep my fingers crossed for you.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" }
                ]
            },
            {
                id: 'L14', section: 'Listening', type: '14. 긴 대화', category: '학습/지식', topic: '사회적 이슈: 환경 보호',
                context: '환경 보호 활동, 재활용, 에너지 절약',
                matches: [
                    { text: "Lets Save Our Planet! ... Stop using plastic! Use a reusable bottle... Use public transportation! ... Recycle! Make sure to recycle all bottles and cans.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" },
                    { text: "What can we do to save the Earth from environmental pollution? ... Do not let the water run while you are brushing your teeth. ... Use Less Plastic.", source: "s15 Yoon's Reading Solutions D 10b" }
                ]
            },
            {
                id: 'L15', section: 'Listening', type: '15. 상황', category: '정보/공지', topic: '메시지 전달: 간접 화법',
                context: '전화 메시지 남기기, 제3자에게 말 전하기',
                matches: [
                    { text: "Could you tell him that Bob called? Okay, I will.", source: "s15 Yoon's Reading Solutions D 10b" },
                    { text: "Please tell him to meet me in the park at eight tomorrow morning.", source: "s15 Yoon's Reading Solutions D 10b" },
                    { text: "Please tell her to call Tim back this afternoon.", source: "s15 Yoon's Reading Solutions D 10b" }
                ]
            },
            {
                id: 'L16', section: 'Listening', type: '16. 담화', category: '학습/지식', topic: '주제: 자연/과학',
                context: '동식물의 특징, 생존 방식, 과학적 사실',
                matches: [
                    { text: "Bears also have a special chemical in their bodies. This chemical helps the bear change the fat in its body to water and protein. This also helps the bear sleep through the winter...", source: "s12 Yoon's Reading Solutions C 9a" },
                    { text: "Some animals help the physically disabled. Others give mental and emotional support to those in need.", source: "s13 POWERUP 3-2 1~2" },
                    { text: "The kakapo is a kind of parrot, but it can't fly. ... Why do kakapos sing songs? To find a mate.", source: "s12 Yoon's Reading Solutions C 9a" },
                    { text: "Trees get water through their leaves. Trees lose their leaves to survive winter.", source: "s11 SMART 중학영어 3학년(2학기) book5~8" }
                ]
            },

            // --- Reading ---
            { 
                id: 'R18', section: 'Reading', type: '18. 목적', category: '정보/공지', topic: '안내문: 학교 축제/행사', 
                context: '학교 축제 및 행사 공지, 일정 안내', 
                matches: [
                    { text: "School Festival When: September 8 Where: Nova Middle School What: School Band Performances, Various Club Events Our school is having a festival. It is on September 8 at Nova Middle School. There will be school band performances and various club events. Please come!", source: "s11 Yoon's 4-Skill Up(Fluent)" },
                    { text: "Autumn Festival! Listen to a live band. Dance with your friends. Take pictures inside the photo booth. It will be a fun and special night.", source: "s13 SMART 중학영어 3학년(2학기) book5~8" }
                ]
            },
            { 
                id: 'R19', section: 'Reading', type: '19. 심경', category: '기타(감정)', topic: '긴장감 → 안도감', 
                context: '사고나 분실 등 위기 상황 후의 안도', 
                matches: [
                    { text: "Our teacher, Mr. Frank, was helping us prepare for a test. ... I couldn't concentrate on my task. My mind was full of worried thoughts. Then Mr. Frank came back. His daughter was all right. I was very relieved.", source: "s11 Advanced Readers D 8b 1~3" },
                    { text: "Later, the farmer's horse came back from the mountains with six wild horses running behind it. ... The neighbors were happy for him. \"You must be relieved!\" they said.", source: "s11 Advanced Readers D 8b 1~3" }
                ]
            },
            {
                id: 'R20', section: 'Reading', type: '20. 주장', category: '심리/사회', topic: '타인과의 비교 지양',
                context: '남과 비교하지 말고 자신의 길을 가라는 교훈',
                matches: [
                    { text: "Most people, however, care so much about what others have that only sadness and sorrow are in their sight. ... However, if you can stop comparing with others, then you can be content and happy.", source: "s11 Advanced Readers D 8b 1~3" },
                    { text: "Not giving up is more important than being class president.", source: "s13 SMART 중학영어 3학년(2학기) book5~8" }
                ]
            },
            {
                id: 'R21', section: 'Reading', type: '21. 함축', category: '심층 사고', topic: '미디어 비판/정보 편식',
                context: '미디어의 영향력, 정보의 선별과 비판적 수용',
                matches: [
                    { text: "Advertisers use words or sentences which deceive people. Indeed they are often misleading because they don't tell the whole truth. Half truths are even harder to find than lies. ... To spend your money wisely, you must be able to read ads.", source: "s12 Core Grammer 1~3.txt / s14 Yoon's Reading Solutions D 10a" }
                ]
            },
            {
                id: 'R22', section: 'Reading', type: '22. 요지', category: '과학/기술/경제', topic: '환경/도시 계획: 녹지 공간',
                context: '습지 보존, 도시 개발과 환경, 자연 공간의 중요성',
                matches: [
                    { text: "Wetlands are extremely important ecosystems. Many endangered animals live in wetlands. Wetlands also prevent floods.", source: "s11 English Immersion Biology 1~2_업데이트_130218" },
                    { text: "There used to be a beautiful park in the center of this city. ... Now there are not parks and houses. I Can see only tall office buildings.", source: "s12 POWERUP 3-1 1~2" }
                ]
            },
            {
                id: 'R23', section: 'Reading', type: '23. 주제', category: '과학/기술/경제', topic: 'Attention Economy/마케팅',
                context: '광고와 주의력(Attention), 사람들의 관심을 끄는 법',
                matches: [
                    { text: "In the world of advertising selling products in the most important goal. It attracts the readers or the viewers' attention. This is done with interesting sentences and pictures that catch your attention.", source: "s12 Core Grammer 1~3" },
                    { text: "Advertisers use many techniques to sell products. First, they use famous people because people want to buy things that famous people advertise.", source: "s12 POWERUP 3-1 1~2" }
                ]
            },
            {
                id: 'R24', section: 'Reading', type: '24. 제목', category: '심층 사고', topic: '예술 작품의 해석/가치',
                context: '예술을 보는 관점, 큐비즘, 예술의 이해',
                matches: [
                    { text: "Cubism broke away from the traditional ways of thinking about art. Cubists used geometric shapes like cubes and cones in the paintings. ... They wanted to capture the essence of the object in the painting by showing it from different points of view at the same time.", source: "s15 Yoon's Advanced Readers F 10b" },
                    { text: "We often feel that art is difficult to understand.", source: "s12 Core Grammer 1~3" }
                ]
            },
            {
                id: 'R29', section: 'Reading', type: '29. 어법', category: '과학/기술/경제', topic: '과학 실험/변인 통제',
                context: '과학 실험 과정, 관찰과 결과 도출',
                matches: [
                    { text: "The teacher showed us how to make rain in a jar. ... Well, it was an experiment that demonstrated convection and the water cycle.", source: "s14 English Immersion Weather and Geology 1~2" },
                    { text: "When you see something your eyes and your brain are working together. Light carries a picture or image of an object into each of your eyes. As light enters your eyes, the image of the object is turned upside down.", source: "s11 Powerup 2-2 3~4" },
                    { text: "First, scientists identify a gene that controls a desirable trait.", source: "s14 Yoon's Reading Solutions D 10a" }
                ]
            },
            {
                id: 'R30', section: 'Reading', type: '30. 어휘', category: '과학/기술/경제', topic: '경제: 불확실성/한계효용',
                context: '경제 원리, 소비 심리, 한계효용 체감',
                matches: [
                    { text: "In economics, here is a law of diminishing marginal utility. According to this law, the amount of marginal utility diminishes as additional units of a product are consumed. It describes how the last item consumed will be less satisfying than the one before.", source: "s14 Yoon's Reading Solutions D 10a" },
                    { text: "Prices go up when many people want to buy the same thing.", source: "s12 Core Grammer 1~3" }
                ]
            },
            {
                id: 'R31', section: 'Reading', type: '31. 빈칸', category: '과학/기술/경제', topic: '디지털 데이터의 영구성',
                context: '디지털 정보의 저장, 기록, 인터넷의 특성',
                matches: [
                    { text: "MP3s are digital data, not physical data like cassettes. Because MP3 files are small, they are accessible through the Internet at any time.", source: "s14 Yoon's Reading PALS D 10a" },
                    { text: "Computers can work with lots of information at the same time. ... Third, they keep information for a long time.", source: "s11 Reading PALS B 8b 1~2" },
                    { text: "In a digital society, you will have to study many subjects. ... The proper knowledge of computers is a must in a digital society.", source: "s13 Reading Solutions C 9b" }
                ]
            },
            {
                id: 'R32', section: 'Reading', type: '32. 빈칸', category: '과학/기술/경제', topic: '생물학: 식물의 생존 전략',
                context: '식물의 적응, 영양분 섭취 방식',
                matches: [
                    { text: "It is difficult to find Venus flytraps in the wild today. Soon, Venus flytraps may only grow in greenhouses. insect-eating plant", source: "s12 Reading Solutions B 8b 1~3_130319 수정" },
                    { text: "The epiphytes' roots stabilize the epiphyte on its growing surface and trap leaves or other debris washed into the roots by rain.", source: "s15 Yoon's Reading Solutions D 10b" }
                ]
            },
            {
                id: 'R33', section: 'Reading', type: '33. 빈칸', category: '심리/사회', topic: 'Attention Economy',
                context: '미디어 소비, 주의력과 만족감',
                matches: [
                    { text: "I think television should be the visual counterpart of the literary essay. It should arouse our dreams, satisfy our hunger for beauty...", source: "s14 English Immersion American culture 1~2" },
                    { text: "Watching TV is a popular after-school activity for American kids. ... Watching television can also affect how well children can read.", source: "s14 English Immersion American culture 1~2" }
                ]
            },
            {
                id: 'R34', section: 'Reading', type: '34. 빈칸', category: '심층 사고', topic: '법/철학: 규칙과 자유',
                context: '규칙 준수, 자유의 제한과 사회적 합의',
                matches: [
                    { text: "To enjoy our freedom, we must allow others to enjoy their liberty also. This demands a lot of self-discipline and self-control.", source: "s11 Powerup 2-2 3~4" },
                    { text: "Traffic signs help enforce laws on the road.", source: "s11 Yoon's 4-Skill Up(Fluent)" },
                    { text: "In Korea, wearing seat belts on the road is required by law. Since the law came into effect, the number of accident deaths has been greatly reduced.", source: "s12 POWERUP 3-1 1~2" }
                ]
            },
            {
                id: 'R35', section: 'Reading', type: '35. 무관', category: '과학/기술/경제', topic: '문화: 고대 건축',
                context: '자금성, 만리장성 등 고대 건축물의 특징',
                matches: [
                    { text: "Many things inside the palace are yellow because yellow is the color for the royal family. ... However, the royal library has a black roof.", source: "s15 Yoon's Reading Solutions D 10b" },
                    { text: "The Great Wall of China begins in Qinhuangdao... Many people say this wall looks like a sleeping dragon draped over the countryside.", source: "s12 English Immersion Famous Places 1~2" },
                    { text: "Stonehenge is in England. No one is sure who built Stonehenge. ... It could have been a burial site for very important people.", source: "s12 Reading Solutions B 8b 1~3_130319 수정" }
                ]
            },
            {
                id: 'R36', section: 'Reading', type: '36. 순서', category: '과학/기술/경제', topic: '과학: 기후 변화와 생태계',
                context: '지구 온난화, 환경 변화가 생물에 미치는 영향',
                matches: [
                    { text: "Why is the earth getting hotter? The problem is a change in the earth’s atmosphere. ... One of these gases is carbon dioxide (CO2). If the temperature rises even a little, big problems could result. ... if the North or South Pole is a few degrees hotter, glaciers will begin to melt.", source: "s14 English Immersion Weather and Geology 1~2" },
                    { text: "If there is too much sediment in the water, the coral's feeding mechanisms will clog and the colony may die.", source: "s15 Yoon's Advanced Readers F 10b" }
                ]
            },
            {
                id: 'R37', section: 'Reading', type: '37. 순서', category: '과학/기술/경제', topic: '생태학: 새들의 무리 짓기',
                context: '동물의 집단 행동, 철새의 비행',
                matches: [
                    { text: "Look, there are a lot of birds in the sky. They're flying in a V formation. That's what geese do.", source: "s11 Powerup 2-2 3~4" },
                    { text: "Oh, I saw some geese flying in a V shape this morning.", source: "s12 POWERUP 3-1 1~2" },
                    { text: "Birds of a feather flock together.", source: "s11 Powerup 2-2 3~4" }
                ]
            },
            {
                id: 'R38', section: 'Reading', type: '38. 삽입', category: '심층 사고', topic: '언어학: 사회적 상호작용',
                context: '언어의 사용, 소통, 언어 습득',
                matches: [
                    { text: "Language is what we use to say things to each other. Birds sing, dogs bark, cats meow, but they don't use words. We do. We use them to describe what we see, hear, and feel.", source: "s12 Core Grammer 1~3" },
                    { text: "Social networking services are popular because they combine many forms of communication into one convenient place.", source: "s13 Reading PALS C 9b" }
                ]
            },
            {
                id: 'R39', section: 'Reading', type: '39. 삽입', category: '과학/기술/경제', topic: '환경/경제: 순환 경제',
                context: '재활용, 업사이클링, 자원 순환',
                matches: [
                    { text: "Reusing, recycling, and composting are three ways to effectively manage waste.", source: "s14 English Immersion American culture 1~2" },
                    { text: "Recycling is about giving an old material a new purpose. The process of upcycling transforms a used product into something of higher value.", source: "s13 SMART 중학영어 3학년(2학기) book5~8" },
                    { text: "One way to deal with our waste is to produce less of it. Source reduction, often called waste prevention, means consuming and throwing away less.", source: "s12 POWERUP 3-1 1~2" },
                    { text: "We can reuse used desks and chairs.", source: "s11 Powerup 2-2 3~4" }
                ]
            },
            {
                id: 'R40', section: 'Reading', type: '40. 요약', category: '심리/사회', topic: '심리: 동조 압력',
                context: '또래 압력(Peer Pressure), 집단 행동의 영향',
                matches: [
                    { text: "Teenagers do many things because of peer pressure. If all your friends smoked you would also smoke because you would want to be one of them. If all your friends wore short skirts, you would wear a short skirt too.", source: "s12 POWERUP 3-1 1~2" },
                    { text: "People don't want to be different from others. If many people are doing the same thing we want to follow.", source: "s12 Core Grammer 1~3" }
                ]
            },
            {
                id: 'R41', section: 'Reading', type: '41-42. 장문', category: '심층 사고', topic: '인문/역사: 기록과 해석',
                context: '역사적 교훈, 사실과 의견 구분',
                matches: [
                    { text: "A newspaper is like a photo of our times and a time capsule of our history. ... In the end, it is your job to tell fact from opinion. You decide what actually happened.", source: "s14 Yoon's Reading Solutions D 10a" },
                    { text: "People who don’t learn from history must repeat it.", source: "s11 Yoon's 4-Skill Up(Fluent)" },
                    { text: "We can also learn from others’ experiences... Ancient leaders started wars for the same reasons as today.", source: "s11 Yoon's 4-Skill Up(Fluent)" }
                ]
            },
            {
                id: 'R43', section: 'Reading', type: '43. 가족애/소통', category: '기타(감정)', topic: '아버지와 아들의 여행/화해',
                context: '아버지와 아들의 캠핑/여행을 통한 유대감 형성, 하이킹',
                matches: [
                    { text: "My name is Travis. Every year my father and I go on a backpacking trip. We drive up into the mountains, leave the car, and take everything we need in our backpacks. ... We hike far into the wilderness.", source: "s14 Yoon's Reading PALS D 10a" },
                    { text: "When I was young, my father and I used to go camping together... It was a special time because it was just for Dad and me... I have made sure to give my son the same special camping experiences that I had with Dad.", source: "s15 Yoon's Advanced Readers F 10b" }
                ]
            }
        ];

        // --- 2. State & Logic ---
        let currentMode = 'Listening'; // 'Listening' or 'Reading'
        let currentFilter = 'All';
        let selectedItemId = null;

        function init() {
            renderCharts();
            populateFilters();
            renderList();
            
            // Auto-select first item
            const firstItem = curriculumData.find(item => item.section === currentMode);
            if(firstItem) selectItem(firstItem.id);
        }

        function setMode(mode) {
            currentMode = mode;
            currentFilter = 'All'; 
            
            // Update UI buttons styling
            const btnList = document.getElementById('btn-listening');
            const btnRead = document.getElementById('btn-reading');
            
            // Reset base styles
            const activeStyle = "bg-white text-amber-600 shadow-sm border border-stone-200";
            const inactiveStyle = "text-stone-500 hover:text-stone-700 hover:bg-stone-200";

            if(mode === 'Listening') {
                btnList.className = `flex-1 md:flex-none px-6 py-2 rounded-md text-sm font-bold transition-all ${activeStyle}`;
                btnRead.className = `flex-1 md:flex-none px-6 py-2 rounded-md text-sm font-bold transition-all ${inactiveStyle}`;
            } else {
                btnList.className = `flex-1 md:flex-none px-6 py-2 rounded-md text-sm font-bold transition-all ${inactiveStyle}`;
                btnRead.className = `flex-1 md:flex-none px-6 py-2 rounded-md text-sm font-bold transition-all ${activeStyle}`;
            }

            populateFilters();
            renderList();
            
            // Auto-select first
            const firstItem = curriculumData.find(item => item.section === mode);
            if(firstItem) selectItem(firstItem.id);
            else {
                document.getElementById('emptyState').classList.remove('hidden');
                document.getElementById('contentState').classList.add('hidden');
            }
        }

        function populateFilters() {
            const select = document.getElementById('categoryFilter');
            select.innerHTML = '<option value="All">모든 카테고리 보기</option>';
            
            // Get unique categories for current mode
            const categories = [...new Set(curriculumData
                .filter(item => item.section === currentMode)
                .map(item => item.category))];
            
            categories.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                select.appendChild(option);
            });
            
            select.value = currentFilter;
        }

        function filterData() {
            currentFilter = document.getElementById('categoryFilter').value;
            renderList();
        }

        function renderList() {
            const listContainer = document.getElementById('itemList');
            listContainer.innerHTML = '';

            const filtered = curriculumData.filter(item => {
                const modeMatch = item.section === currentMode;
                const filterMatch = currentFilter === 'All' || item.category === currentFilter;
                return modeMatch && filterMatch;
            });

            document.getElementById('matchCount').textContent = `${filtered.length}건`;

            if (filtered.length === 0) {
                listContainer.innerHTML = '<div class="p-8 text-center text-stone-400 text-sm flex flex-col items-center"><i class="fa-regular fa-folder-open text-2xl mb-2"></i>해당 조건의 데이터가 없습니다.</div>';
                return;
            }

            filtered.forEach(item => {
                const el = document.createElement('div');
                const isSelected = selectedItemId === item.id;
                
                // Styling
                let baseClass = "p-3 rounded-lg cursor-pointer transition-all border text-left group relative overflow-hidden";
                if(isSelected) {
                    baseClass += " bg-white border-amber-500 shadow-md transform scale-[1.02] z-10";
                } else {
                    baseClass += " bg-white border-transparent hover:bg-white hover:border-stone-300 hover:shadow-sm";
                }

                el.className = baseClass;
                el.onclick = () => selectItem(item.id);

                // Multiple matches indicator
                const matchCountBadge = item.matches.length > 1 
                    ? `<span class="ml-2 text-[10px] bg-stone-100 text-stone-500 px-1.5 rounded border border-stone-200" title="${item.matches.length}개의 교재 지문 매칭">+${item.matches.length} Sources</span>` 
                    : '';

                el.innerHTML = `
                    <div class="flex justify-between items-start mb-1">
                        <span class="text-xs font-bold ${isSelected ? 'text-amber-600' : 'text-stone-500 group-hover:text-stone-700'}">${item.type}</span>
                        <span class="text-[10px] px-2 py-0.5 rounded-full bg-stone-100 text-stone-500 border border-stone-100">${item.category}</span>
                    </div>
                    <div class="font-bold text-sm text-stone-800 line-clamp-1 group-hover:text-amber-600 transition-colors">${item.topic}</div>
                    <div class="mt-1 flex items-center">
                         ${matchCountBadge}
                    </div>
                    ${isSelected ? '<div class="absolute left-0 top-0 bottom-0 w-1 bg-amber-500"></div>' : ''}
                `;
                listContainer.appendChild(el);
            });
        }

        function selectItem(id) {
            selectedItemId = id;
            renderList(); // Re-render list to update active states

            const item = curriculumData.find(d => d.id === id);
            if (!item) return;

            // Toggle Views
            document.getElementById('emptyState').classList.add('hidden');
            const content = document.getElementById('contentState');
            content.classList.remove('hidden');
            
            // Animation reset
            content.classList.remove('fade-in');
            void content.offsetWidth; 
            content.classList.add('fade-in');

            // Populate Content Header
            document.getElementById('detailBadge').textContent = item.category;
            document.getElementById('detailTitle').textContent = item.type;
            document.getElementById('detailTopic').textContent = `유사 소재: ${item.topic}`;
            document.getElementById('detailContext').textContent = item.context;

            // Populate Matches (Multiple Source Extracts)
            const matchesContainer = document.getElementById('matchesContainer');
            matchesContainer.innerHTML = ''; // Clear previous

            item.matches.forEach((match, index) => {
                const card = document.createElement('div');
                card.className = "bg-amber-50 p-5 rounded-lg border border-amber-200 shadow-sm relative group hover:shadow-md transition-shadow";
                
                card.innerHTML = `
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-xs font-bold text-white bg-amber-500 px-2 py-0.5 rounded uppercase tracking-wider">Proof ${index + 1}</span>
                        <span class="text-xs font-mono text-stone-500 bg-white px-2 py-1 rounded border border-stone-200 shadow-sm group-hover:text-amber-700 group-hover:border-amber-200 transition-colors">
                            <i class="fa-solid fa-book mr-1"></i>${match.source}
                        </span>
                    </div>
                    <p class="font-serif text-lg text-stone-800 leading-relaxed italic relative z-10 pl-4 border-l-2 border-amber-300">
                        "${match.text}"
                    </p>
                    <i class="fa-solid fa-quote-right absolute bottom-4 right-4 text-4xl text-amber-200/50 -z-0"></i>
                `;
                matchesContainer.appendChild(card);
            });
        }

        function scrollToSection(id) {
            const element = document.getElementById(id);
            if(element) {
                const headerOffset = 80;
                const elementPosition = element.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                window.scrollTo({ top: offsetPosition, behavior: "smooth" });
            }
        }

        function renderCharts() {
            // Data Prep
            const categoryCounts = {};
            curriculumData.forEach(item => {
                categoryCounts[item.category] = (categoryCounts[item.category] || 0) + 1;
            });

            // 1. Topic Distribution (Doughnut)
            const ctxTopic = document.getElementById('topicChart').getContext('2d');
            new Chart(ctxTopic, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(categoryCounts),
                    datasets: [{
                        data: Object.values(categoryCounts),
                        backgroundColor: [
                            '#f59e0b', // Amber 500
                            '#3b82f6', // Blue 500
                            '#10b981', // Emerald 500
                            '#8b5cf6', // Violet 500
                            '#ef4444', // Red 500
                            '#6366f1', // Indigo 500
                        ],
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            position: 'bottom', 
                            labels: { boxWidth: 12, padding: 20, font: { family: 'Noto Sans KR', size: 11 } } 
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return ` ${context.label}: ${context.raw}문항`;
                                }
                            },
                            backgroundColor: 'rgba(68, 64, 60, 0.9)', // Stone 700
                            padding: 12
                        }
                    },
                    cutout: '65%'
                }
            });

            // 2. Type Count (Bar)
            const listeningCount = curriculumData.filter(i => i.section === 'Listening').length;
            const readingCount = curriculumData.filter(i => i.section === 'Reading').length;

            const ctxType = document.getElementById('typeChart').getContext('2d');
            new Chart(ctxType, {
                type: 'bar',
                data: {
                    labels: ['듣기 (Listening)', '읽기 (Reading)'],
                    datasets: [{
                        label: '적중 문항 수',
                        data: [listeningCount, readingCount],
                        backgroundColor: ['#d97706', '#57534e'], // Amber 600, Stone 600
                        borderRadius: 6,
                        barThickness: 50
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { 
                            beginAtZero: true, 
                            max: 30,
                            grid: { display: true, drawBorder: false, color: '#f5f5f4' },
                            ticks: { font: { family: 'Noto Sans KR' } }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { font: { family: 'Noto Sans KR', weight: 'bold' } }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(68, 64, 60, 0.9)',
                            padding: 10
                        }
                    }
                }
            });
        }

        // Initialize on load
        window.addEventListener('load', init);

    </script>
</body>
</html>
